<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.110.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>The Future of Machine Learning is not Python, it's SQL &#183; Gabe</title><meta name=description content="Python is touted as the language to learn and use for DS and ML thanks to its easy to understand syntax making it quick to write, free and open-source for simple adoption, vast DS & ML toolset making you spoilt for choice, and large community ready to help. However, there are many cracks which start to show when using Python in production."><link type=text/css rel=stylesheet href=https://gabriel.gaucimaistre.com/css/print.css media=print><link type=text/css rel=stylesheet href=https://gabriel.gaucimaistre.com/css/poole.css><link type=text/css rel=stylesheet href=https://gabriel.gaucimaistre.com/css/syntax.css><link type=text/css rel=stylesheet href=https://gabriel.gaucimaistre.com/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png><meta property="og:title" content="The Future of Machine Learning is not Python, it's SQL"><meta property="og:description" content="Python is touted as the language to learn and use for DS and ML thanks to its easy to understand syntax making it quick to write, free and open-source for simple adoption, vast DS & ML toolset making you spoilt for choice, and large community ready to help. However, there are many cracks which start to show when using Python in production."><meta property="og:type" content="article"><meta property="og:url" content="https://gabriel.gaucimaistre.com/2023/02/the-future-of-machine-learning-is-not-python-its-sql/"><meta property="og:image" content="https://gabriel.gaucimaistre.com/images/make-sql-great-again.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-19T10:00:00+00:00"><meta property="article:modified_time" content="2023-02-19T10:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://gabriel.gaucimaistre.com/images/make-sql-great-again.png"><meta name=twitter:title content="The Future of Machine Learning is not Python, it's SQL"><meta name=twitter:description content="Python is touted as the language to learn and use for DS and ML thanks to its easy to understand syntax making it quick to write, free and open-source for simple adoption, vast DS & ML toolset making you spoilt for choice, and large community ready to help. However, there are many cracks which start to show when using Python in production."></head><body class=theme-base-0g><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://gabriel.gaucimaistre.com/></a><img src=/images/avatar.jpg></a><h1>Gabe</h1><p class=lead>Data Scientist</p><p class=description>I have opinions and make people read them.</p></div><nav><ul class=sidebar-nav><li><a href=https://gabriel.gaucimaistre.com/>Home</a></li><li><a href=/about/>About</a></li><li><a href=https://github.com/gabegm/>Github</a></li><li><a href=https://www.linkedin.com/in/gabegm/>LinkedIn</a></li><li><a href=/index.xml>RSS</a></li><li><a href=https://twitter.com/itsgabegm/>Twitter</a></li></ul></nav><p>&copy; Gabriel Gauci Maistre 2023. All rights reserved.</p></div></aside><main class="content container"><div class=post><h1>The Future of Machine Learning is not Python, it's SQL</h1><time datetime=2023-02-19T10:00:00Z class=post-date>Sun, Feb 19, 2023</time><p class=tags>Tags: <a href=/tags/python>python</a> <a href=/tags/sql>sql</a> <a href=/tags/data-science>data science</a> <a href=/tags/machine-learning>machine learning</a></p><p><img src=/images/make-sql-great-again.png alt="alt text" title="Make SQL great again!"></p><p>Python is often touted as the language to learn and use for Data Science (DS) and Machine learning (ML), thanks to its easy to understand syntax making it quick to write, free and open-source for easy adoption, vast DS & ML toolset (libraries and frameworks) spoiling you for choice, and a large community ready to help. Many businesses mining their data are doing it in Python nowadays, which means that there&rsquo;s a huge demand for Python skills and a large talent pool to tap into. However, while all this sounds like a no-brainer, there are many cracks which start to show when deploying Python in production for DS & ML.</p><p>Python may indeed be easy to learn and use, however it is often rarely used in production for DS & ML sucessfully. It is extremely slow when compared to other back-end programming languages, and its lack of type safety can cause many issues in critical flows on production. Many companies follow the approach of rewriting DS models written in Python in a language their tech stack supports, such as Java. This is mostly due to the language&rsquo;s lack of reliabilty when compared to other back-end languages.</p><h2 id=the-current-situation>The Current Situation</h2><p><img src=/images/what-is-this-ds-model.png alt="alt text" title="What the hell is this?"></p><p>Now you probably must be thinking, what&rsquo;s wrong with rewriting such models in another language? Python is great for prototyping as its quick and easy to get started, so why not use a more robust language for porting to production? Let&rsquo;s take a moment to play this scnario out. A Data Scientist is tasked with developing a model to predict a business related KPI. The Data Scientist completes the project and presents it to the business with success. This is where a back-end engineer is tasked with porting this model to deploy on the back-end. If the Data Scientist were proficient in writing good clean code, the engineer should be able to quickly reproduce the work done so far and take over from there.</p><p>But this is seldom the case. Data Scientists tend to have stronger mathematical backgrounds, and finding those with good software engineering skills is extremely hard. Many times such DS models are written in interactive notebooks, having many code cells which are no longer relevant, do not work, were run out of order, or are not able to be reproduced since the engineer did not have the exact dependencies used to run the notebook.</p><p>However, even if this is not the case and the Data Scientist followed good software engineering practices, the back-end engineer tasked with rewriting the model from one language to another, which in itself is never a simple task due to language differences, is rarely the expert in DS & ML and neither is the Data Scientist in Software Engineering. This tends to increase the risks for communication breakdowns and the end results not reflecting those of the initial DS model.</p><p>Python is also the standard for DS & ML thanks to the large vast of open-source libraries and frameworks that have been developed over the years and battle tested by academics. This is hard to find in any other language, where most of the times such tools will either be missing, or their implementation is not pure to the language but simply a binding to the Python tool. This means that the rewrites of such Python models will take a hefty amount of time and will likely introduce bugs which did not exist in the initial Python model.</p><p>The issues of performance are not just specific to Python, microservices built to serve such predictions are by design separating data from code which creates a large bottleneck. For training of such DS models, large amounts of data need to be first unloaded from the database, and the same goes for serving predictions.</p><p>All of this creates the risk of DS & ML projects ending in failure, as the implementation either takes to look to complete, or the final results do not reflect those of the initial ones.</p><h2 id=the-future>The Future</h2><p><img src=/images/society-if-ds-used-sql.png alt="alt text" title="Society if Data Scientists' used SQL to develop and deploy their models"></p><p>So what&rsquo;s a solution to such problems? For many years database vendors have made it possible to extend database functions using programming languages such as Python. This made it easier to go beyond the limits of a query language like SQL with that of a programming language such as Python. However these features always had limitations, such as implementing Python libraries which were not written in pure Python underneath the hood, as most Python libraries are to combat the lack of speed of the language. However, nowadays many modern database vendors are starting to overcome such limitations and are implementing ML algorithms as SQL functions.</p><p>PostgresML is an open-source extension developed for the widely popular Postgres database system, which has been battle tested in many production environments, providing you with access to various ML algorithms and models from the most popular libraries such as Scikit Learn, XGBoost, and LightGBM, but also pre-trained deep learning models from Hugging Face, all without needing to write any code. Since the ML functions needed are now available within the database, there is also no need to un/load large amounts of data from the database, keeping performance and reliability high.</p><p>It is far more efficient to move your code to where your data lives rather than move your data to where your code does. There is also no need to worry about extra security, as the data does not need to leave the database. Data Scientists can now be in full control of their own model deployments, just as they designed them, thanks to model periodic training and versioning with rollback capability. It is now also easier for ML models to be shared and reused by other applications and users as they are stored directly in the database.</p><p>If Python is great for DS & ML because it&rsquo;s so easy to use and learn, SQL should be an even bigger contender as it is easier to pick up being a query language rather than a programming language. There is also more talent with SQL experience than Python as almost all database vendors support SQL. Why not build your DS model in the same place where you query your data? PostgresML is just one example, other cloud vendors also provide the ability to extend their in-house data stores with ML algorithms, however I used PostgresML as an example as it does not introduce vendor lock-in. Also, since PostgresML is open-source, any ML algorithms which have not yet been implemented in the extension, can easily be be requested or added.</p><h2 id=a-sneak-peak-into-postgresml>A Sneak Peak into PostgresML</h2><p>Since PostgresML only requires SQL, its syntax is fairly easy to use. Just as in ML libraries in Python, we have a train and a predict function to build predictions. Both these functions provide very similar arguments to what&rsquo;s available in their corresponding Python ML libraries.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span> pgml.train(
</span></span><span style=display:flex><span>    project_name TEXT <span style=color:#75715e>-- used to identify this machine learning project
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , task TEXT <span style=color:#66d9ef>DEFAULT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#75715e>-- predict true or false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , relation_name TEXT <span style=color:#66d9ef>DEFAULT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#75715e>-- the data table
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , y_column_name TEXT <span style=color:#66d9ef>DEFAULT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#75715e>-- the column to predict
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , algorithm TEXT <span style=color:#66d9ef>DEFAULT</span> <span style=color:#e6db74>&#39;linear&#39;</span> <span style=color:#75715e>-- the ML algorithm
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , hyperparams JSONB <span style=color:#66d9ef>DEFAULT</span> <span style=color:#e6db74>&#39;{}&#39;</span>::JSONB
</span></span><span style=display:flex><span>    , <span style=color:#66d9ef>search</span> TEXT <span style=color:#66d9ef>DEFAULT</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>    , search_params JSONB <span style=color:#66d9ef>DEFAULT</span> <span style=color:#e6db74>&#39;{}&#39;</span>::JSONB
</span></span><span style=display:flex><span>    , search_args JSONB <span style=color:#66d9ef>DEFAULT</span> <span style=color:#e6db74>&#39;{}&#39;</span>::JSONB
</span></span><span style=display:flex><span>    , test_size REAL <span style=color:#66d9ef>DEFAULT</span> <span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>25</span> <span style=color:#75715e>-- the size to reserve for testing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , test_sampling TEXT <span style=color:#66d9ef>DEFAULT</span> <span style=color:#e6db74>&#39;random&#39;</span> <span style=color:#75715e>-- whether to take a random sample of a specific order
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pgml.predict (
</span></span><span style=display:flex><span>    project_name TEXT <span style=color:#75715e>-- the name used to create the machine learning project
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , features REAL[] <span style=color:#75715e>-- the columns needed to predict
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><p>Once we have a table prepared for our model, we can use the train function.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> pgml.train(
</span></span><span style=display:flex><span>  project_name <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Fraud Classifier&#39;</span>
</span></span><span style=display:flex><span>  , task <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;classification&#39;</span>
</span></span><span style=display:flex><span>  , relation_name <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;fraud_samples&#39;</span>
</span></span><span style=display:flex><span>  , y_column_name <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;fraudulent&#39;</span>
</span></span><span style=display:flex><span>  , algorithm <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;xgboost&#39;</span>
</span></span><span style=display:flex><span>  , test_size <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  , test_sampling <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;last&#39;</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>     project      <span style=color:#f92672>|</span>      task      <span style=color:#f92672>|</span>   algorithm   <span style=color:#f92672>|</span>   deployed    <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span><span style=color:#75715e>------------------|----------------|---------------|---------------|
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>|</span> Fraud Classifier <span style=color:#f92672>|</span> classification <span style=color:#f92672>|</span> 	 xgboost    <span style=color:#f92672>|</span> 	   <span style=color:#66d9ef>true</span>     <span style=color:#f92672>|</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>  perishable_percentage <span style=color:#75715e>-- feature
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  , fraudulent <span style=color:#66d9ef>AS</span> y_true <span style=color:#75715e>-- the true classification
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  , pgml.predict(<span style=color:#e6db74>&#39;Fraud Classifier&#39;</span>, ARRAY[perishable_percentage::real]) <span style=color:#66d9ef>AS</span> y_pred <span style=color:#75715e>-- the predicted classification
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>FROM</span> fraud_samples;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> y_pred  <span style=color:#f92672>|</span> y_true <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span><span style=color:#75715e>---------|--------|
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>|</span>  <span style=color:#66d9ef>false</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>0</span>    <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#66d9ef>true</span>   <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span>    <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#66d9ef>false</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span>    <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#66d9ef>true</span>   <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span>    <span style=color:#f92672>|</span>
</span></span></code></pre></div><p>Once the model is ready to be deployed, we can use the deploy function along with a strategy on how newer versions of the model should be deployed, along with an algorithm or a list of algorithms to be chosen based on their performance.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>pgml.deploy(
</span></span><span style=display:flex><span>    project_name TEXT <span style=color:#75715e>-- used to identify machine learning project
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , strategy TEXT <span style=color:#66d9ef>DEFAULT</span> <span style=color:#e6db74>&#39;best_score&#39;</span> <span style=color:#75715e>-- &#39;rollback&#39;, &#39;best_score&#39;, or &#39;most_recent&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    , algorithm TEXT <span style=color:#66d9ef>DEFAULT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#75715e>-- filter candidates to a particular algorithm, NULL = all qualify
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- deploy the &#34;best&#34; model for prediction use
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> pgml.deploy(<span style=color:#e6db74>&#39;Handwritten Digits&#39;</span>, <span style=color:#e6db74>&#39;best_score&#39;</span>);
</span></span></code></pre></div><p>Still interested? The PostgresML team have launched an <a href=https://postgresml.org/blog/data-is-living-and-relational/>interactive environment</a> for anyone to launch a test database and give it a try. There are also a couple of sample notebooks which make use of some sample data bundled with PostgresML to show you the ins and outs of the extension.</p><h2 id=conclusion>Conclusion</h2><p>Although PostgresML is a great example of using ML directly in the database, Postgres is not the ideal database for every ML application. Postgres is an Online Transactional Processing (OLTP) database, which makes it great at powering back-end web systems, but not Online Analytical Processing (OLAP) databases used analytical data warehousing.</p><p>There are of course alternative OLAP databases which also offer the same features which PostresML does, and although the list grows year after year, not all database vendors will offer the same level of features, such as evaluation of model performance and accuracy. Such requirements will ultimately restrict your choice of datbase vendors.</p></div></main></body></html>